[ARCHIPELAGO]
# Switch peer processes to run as this user
USER=archipelago
# Switch peer processes to run as this group
GROUP=archipelago
# Enable blktap module. Possible values: True/False
BLKTAP_ENABLED=True

# xseg
[XSEG]
# Max xseg ports supported by segment
SEGMENT_PORTS = 2048
SEGMENT_DYNPORTS = 1024

# Max segment size
# The size of the shared memory segment in MiB.
# Allowed values: Any positive integer.
#
# A good rule of thumb for one to calculate an appropriate segment size would be
# the following formula:
#     256 + 128 * 0.5 * NR_VM_VOLUMES
# where:
#     - 256 is the base size,
#     - 128 is the average max number of requests,
#     - 0.5 is the max request size in MiB (512KB), (This is enforced by the
#       tapdisk process.)
#     - NR_VM_VOLUMES is the expected number of volumes the host will have.
#
# or for a Pithos node:
#     256 + NR_OF_GUNICORN_WORKERS * POOL_SIZE * 4
# where:
#     - 256 is the base size,
#     - 4 is the max request size in MiB. (This is enforced by Pithos logic.)
SEGMENT_SIZE = 2048

# Start of port range that can be used by the vlmc tool
VTOOL_START=1003
# End of port range that can be used by the vlmc tool
VTOOL_END=1022

# (peer role, peer type)
# Mandatory peer roles:
# 	blockerb
# 	blockerm
# 	mapperd
# 	vlmcd
#
# Available peer types:
# 	rados_blocker
# 	file_blocker
# 	mapperd
# 	vlmcd
#
[PEERS]
ROLES=blockerb blockerm mapperd vlmcd
# Order matters. Peers will be started with list order and stopped with reversed
# order.
ORDER=blockerb blockerm mapperd vlmcd


# Generic peer options
# portno_start: Start of port range that will be used by the peer
# portno_end: End of port range that will be used by the peer
# nr_ops: Max number of flying operations. Must be a power of 2.
# log_level: verbosity levels for each xseg peer
#            0 - Error
#            1 - Warnings
#            2 - Info
#            3 - Debug
# Warning: debug level 3 logs A LOT!
# nr_threads: Number of threads of each peer. Currently only blockers supports
# 	      threads with the following tricks:
# 	      a) Threads in file_blocker are I/O threads that block.
# 	      b) Threads in rados_blocker are processing threads. For lock
# 	      congestion reasons, avoid setting them to a value larger than 4.


# file_blocker specific options:
#
# archip_dir: Where archipelago files will reside
# fdcache: Fd cache size

# rados_blocker specific options:
#
# pool: rados pool where objects will reside

[blockerb]
type=rados_blocker
portno_start=1000
portno_end=1000
log_level=2
nr_ops=512
pool=blocks
#cephx_id=admin
umask=007

[blockerm]
type=rados_blocker
portno_start=1002
portno_end=1002
log_level=2
nr_ops=512
pool=maps
#cephx_id=admin
umask=007

# mapperd specific options:
#
# blockerb_port: target port that will be used to communicate with the blockerb
# blockerm_port: target port that will be used to communicate with the blockerm

[mapperd]
type=mapperd
portno_start=1001
portno_end=1001
log_level=2
nr_ops=512
blockerb_port=1000
blockerm_port=1002
umask=007

# vlmcd specific options:
#
# blocker_port: target port that will be used to communicate with the blockerb
# mapper_port: target port that will be used to communicate with the mapper

[vlmcd]
type=vlmcd
portno_start=500
portno_end=999
log_level=2
nr_ops=512
blocker_port=1000
mapper_port=1001
umask=007
